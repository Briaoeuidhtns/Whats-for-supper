{"version":3,"sources":["serviceWorker.ts","features/recipes/recipeSlice/recipeDataSlice.ts","recipes.ts","util/errors.ts","features/recipes/recipeSlice/couchDataSlice.ts","util/types/redux.ts","features/recipes/recipeSlice/combinedActions.ts","features/recipes/recipeSlice/uiSlice.ts","features/recipes/recipeSlice/combined.ts","components/TagInput.tsx","features/recipes/AddRecipe.tsx","features/recipes/RecipeCard.tsx","util/hooks.ts","util/types/misc.ts","features/recipes/RecipeStack.tsx","features/recipes/Reactions.tsx","components/App.tsx","app/rootReducer.ts","app/store.ts","components/ErrorBoundary.tsx","features/voice/index.ts","components/RehydrateGuard.tsx","util/redux.ts","util/test.ts","util/types/pouchdb.ts","app/db.ts","globalStyle.ts","index.tsx"],"names":["Boolean","window","location","hostname","match","initialState","recipes","title","description","image","tags","keyfn","val","salt","hash","update","JSON","stringify","digest","h","map","a","parseInt","reduce","b","length","recipeDataSlice","createSlice","name","reducers","addRecipe","state","recipe","payload","push","shuffleRecipes","sort","rating","actions","selectRecipes","InvalidReducerCallError","action","msg","Error","minimalInitialState","rehydrated","undefined","getFromCouch","createAction","addDefaultRecipes","getFromCouchReducer","recipeDataReducer","type","startsWith","isReduxInternalAction","makeRecipe","removeRecipe","recipeSlice","index","showDescription","nextRecipe","prevRecipe","toggleDescription","extraReducers","addCase","selectRecipeUi","recipeUi","selectIndex","createSelector","ui","selectShowDescription","availabilityStateMap","hasPrev","has","hasNext","recipeReducer","combineReducers","createReducer","splice","selectedRecipe","Math","max","reduceReducers","TagInput","recipeTags","setRecipeTags","Box","Autocomplete","multiple","freeSolo","renderTags","value","getTagProps","option","Chip","variant","label","onChange","_","newValue","renderInput","params","TextField","placeholder","fullWidth","mapDispatch","useStyles","makeStyles","theme","createStyles","fab","position","bottom","spacing","right","fieldset","borderColor","marginLeft","paddingLeft","legend","pointerEvents","connect","classes","useState","open","setOpen","recipeText","setRecipeText","recipeRating","setRecipeRating","recipeDescription","setRecipeDescription","cancel","className","Fab","onClick","Add","Dialog","onClose","DialogTitle","DialogContent","DialogContentText","autoFocus","margin","e","target","multiline","rows","component","Typography","color","Rating","id","size","DialogActions","Button","trim","encodeURI","ExpandableIcon","expand","ExpandLess","ExpandMore","media","height","paddingTop","RecipeCard","menuButton","props","Card","CardMedia","CardHeader","CardContent","txt","i","key","readOnly","CardActions","IconButton","disabled","Collapse","in","timeout","unmountOnExit","paragraph","getSize","width","innerWidth","innerHeight","useElSize","ref","useRef","bounds","setBounds","ResizeObserver","entry","contentRect","ro","useEffect","current","observe","disconnect","data","tuple","TUTORIAL_RECIPE","selectRecipe","slice","head","next","mapState","currentRecipe","cardStack","display","gridTemplate","placeItems","userSelect","gridColumn","gridRow","zIndex","top","menuAnchor","setMenuAnchor","windowSize","setWindowSize","handleResize","addEventListener","removeEventListener","useWindowSize","bindCardSize","cardSize","edgeThreshold","isLeaving","useSpring","x","opacity","onRest","setSpring","reset","springStyle","bindDrag","useDrag","down","mx","movement","abs_x","xy","swipe","abs","sign","closeMenu","headCard","div","style","currentTarget","nextCard","Menu","anchorEl","MenuItem","ListItemIcon","Delete","ButtonGroup","App","Container","maxWidth","RecipeStack","AddRecipe","rootReducer","store","configureStore","reducer","devTools","process","middleware","Sentry","level","Info","message","error","getState","getDefaultMiddleware","hasError","errorInfo","eventId","this","setState","children","_error","React","Component","SpeechRecognition","webkitSpeechRecognition","initVoiceRecognition","callback","commands","grammar","join","recogniser","grammars","addFromString","onend","start","onresult","res","cmd","last","results","transcript","RehydrateGuard","loading","useSelector","observeStore","mstore","currentState","selector","identity","handleChange","nextState","isEqual","unsubscribe","subscribe","testAwait","p","isPouchDBError","result","PouchDB","plugin","Upsert","shuffleSalt","Date","now","body","overflow","dsn","release","environment","async","host","port","db","get","dbget","dispatch","status","sync","live","retry","on","change","docs","upsert","oldstate","console","initDB","REACT_APP_COUCHDB_HOST","REACT_APP_COUCHDB_PORT","REACT_APP_COUCHDB_DB","render","LinearProgress","document","getElementById","back","select","Object","keys","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.4d1012e1.chunk.js","sourcesContent":["// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n)\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void\n  onUpdate?: (registration: ServiceWorkerRegistration) => void\n}\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    )\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          )\n        })\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      )\n    })\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister()\n    })\n  }\n}\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit'\nimport { RootState } from 'app/rootReducer'\nimport { sha1 as hash } from 'hash.js'\nimport InitialRecipes from 'recipes'\n\nexport interface Recipe {\n  title: string\n  description: string\n  image?: string\n  rating?: number\n  tags: string[]\n}\n\nexport interface RecipeListState {\n  recipes: Recipe[]\n}\n\nexport const initialState: RecipeListState = {\n  recipes: InitialRecipes,\n}\n\n// To the best of my knowledge, this generates a normalish distribution\nconst keyfn = (val: Recipe, salt: any) => {\n  const variance = 15\n  const [...h] = hash()\n    .update(JSON.stringify({ val, salt }))\n    .digest('hex')\n\n  const shift =\n    (h.map(a => parseInt(a, 16)).reduce((a, b) => a + b) -\n      (15 * h.length) / 2) / // Shift center to 0\n    variance // Shrink the range\n\n  return shift\n}\n\nconst recipeDataSlice = createSlice({\n  name: 'recipes',\n  initialState,\n  reducers: {\n    addRecipe(state, { payload: recipe }: PayloadAction<Recipe>) {\n      state.recipes.push(recipe)\n    },\n    shuffleRecipes(state, { payload: salt }: PayloadAction<any>) {\n      state.recipes.sort(\n        (a, b) =>\n          keyfn(b, salt) + (b.rating ?? 0) - (keyfn(a, salt) + (a.rating ?? 0))\n      )\n    },\n  },\n})\n\nexport const { addRecipe, shuffleRecipes } = recipeDataSlice.actions\n\nexport const selectRecipes = (state: RootState) => state.recipes.recipes\n\nexport default recipeDataSlice.reducer\n","import { Recipe } from 'features/recipes/recipeSlice'\n\nconst recipes: Recipe[] = [\n  {\n    title: 'Arroz con Pollo',\n    description:\n      '[Wikibook Cookbook link](https://en.wikibooks.org/wiki/Cookbook:Arroz_con_Pollo)',\n    image:\n      '//upload.wikimedia.org/wikipedia/commons/thumb/3/39/Arroz-con-Pollo.jpg/300px-Arroz-con-Pollo.jpg',\n    tags: ['Chicken', 'Spanish'],\n  },\n  {\n    title: 'Arroz Negro',\n    description:\n      '[Wikibook Cookbook link](https://en.wikibooks.org/wiki/Cookbook:Arroz_Negro)',\n    image:\n      '//upload.wikimedia.org/wikipedia/commons/thumb/5/5b/Arroz_negro_02.JPG/350px-Arroz_negro_02.JPG',\n    tags: ['Squid', 'Spanish'],\n  },\n  {\n    title: 'Bangers & Mash',\n    description:\n      '[Wikibook Cookbook link](https://en.wikibooks.org/wiki/Cookbook:Bangers_%26_Mash)',\n    image:\n      '//upload.wikimedia.org/wikipedia/commons/thumb/6/68/Bangers_and_mash_1.jpg/250px-Bangers_and_mash_1.jpg',\n    tags: ['Pork', 'British'],\n  },\n  {\n    title: 'Barbecued Spare Ribs',\n    description:\n      '[Wikibook Cookbook link](https://en.wikibooks.org/wiki/Cookbook:Barbecued_Spare_Ribs)',\n    image:\n      '//upload.wikimedia.org/wikipedia/commons/thumb/1/15/Spare_ribs_with_Chinese_barbecue_sauce_cropped.jpg/300px-Spare_ribs_with_Chinese_barbecue_sauce_cropped.jpg',\n    tags: ['Beef', 'Barbeque'],\n  },\n  {\n    title: 'Boeuf Bourguignon',\n    description:\n      '[Wikibook Cookbook link](https://en.wikibooks.org/wiki/Cookbook:Boeuf_Bourguignon)',\n    image:\n      '//upload.wikimedia.org/wikipedia/commons/thumb/5/53/Boeuf_bourguignon_servi_avec_des_p%C3%A2tes.jpg/290px-Boeuf_bourguignon_servi_avec_des_p%C3%A2tes.jpg',\n    tags: ['Beef', 'French'],\n  },\n  {\n    title: 'Bulgogi',\n    description:\n      '[Wikibook Cookbook link](https://en.wikibooks.org/wiki/Cookbook:Bulgogi)',\n    image:\n      '//upload.wikimedia.org/wikipedia/commons/thumb/c/c8/Korean.food-Bulgogi-01.jpg/300px-Korean.food-Bulgogi-01.jpg',\n    tags: ['Beef', 'Korean'],\n  },\n  {\n    title: 'Calzone',\n    description:\n      '[Wikibook Cookbook link](https://en.wikibooks.org/wiki/Cookbook:Calzone)',\n    image:\n      '//upload.wikimedia.org/wikipedia/commons/thumb/6/6d/20000227--calzone.jpg/300px-20000227--calzone.jpg',\n    tags: ['Pork', 'Beef', 'Italian'],\n  },\n  {\n    title: 'Chicken Biryani',\n    description:\n      '[Wikibook Cookbook link](https://en.wikibooks.org/wiki/Cookbook:Chicken_Biryani)',\n    image:\n      '//upload.wikimedia.org/wikipedia/commons/thumb/0/0c/BurmeseBiryani.jpg/300px-BurmeseBiryani.jpg',\n    tags: ['Chicken', 'Italian'],\n  },\n  {\n    title: 'Chicken Curry',\n    description:\n      '[Wikibook Cookbook link](https://en.wikibooks.org/wiki/Cookbook:Chicken_Curry)',\n    image:\n      '//upload.wikimedia.org/wikipedia/commons/thumb/a/a5/Chicken_Karaage_Curry%2C_Y.Izakaya%2C_Paris_001.jpg/250px-Chicken_Karaage_Curry%2C_Y.Izakaya%2C_Paris_001.jpg',\n    tags: ['Chicken', 'Indian'],\n  },\n  {\n    title: 'Chicken Tikka Masala',\n    description:\n      '[Wikibook Cookbook link](https://en.wikibooks.org/wiki/Cookbook:Chicken_Tikka_Masala)',\n    image:\n      '//upload.wikimedia.org/wikipedia/commons/thumb/1/13/Chicken_Tikka_Masala_Curry.png/250px-Chicken_Tikka_Masala_Curry.png',\n    tags: ['Chicken', 'Asian'],\n  },\n  {\n    title: 'Chicken Vindaloo',\n    description:\n      '[Wikibook Cookbook link](https://en.wikibooks.org/wiki/Cookbook:Chicken_Vindaloo)',\n    image:\n      '//upload.wikimedia.org/wikipedia/commons/thumb/e/e0/Chicken_Vindaloo.jpeg/300px-Chicken_Vindaloo.jpeg',\n    tags: ['Chicken', 'Indian'],\n  },\n  {\n    title: 'Chow Mein',\n    description:\n      '[Wikibook Cookbook link](https://en.wikibooks.org/wiki/Cookbook:Chow_Mein)',\n    image:\n      '//upload.wikimedia.org/wikipedia/commons/thumb/d/d1/Chow_mein_1_by_yuen.jpg/300px-Chow_mein_1_by_yuen.jpg',\n    tags: ['Egg', 'Chinese'],\n  },\n  {\n    title: 'Com Chien',\n    description:\n      '[Wikibook Cookbook link](https://en.wikibooks.org/wiki/Cookbook:Com_Chien)',\n    image:\n      '//upload.wikimedia.org/wikipedia/commons/thumb/d/d1/Com_chien.jpg/300px-Com_chien.jpg',\n    tags: ['Egg', 'Chinese'],\n  },\n  {\n    title: 'Coronation Chicken',\n    description:\n      '[Wikibook Cookbook link](https://en.wikibooks.org/wiki/Cookbook:Coronation_Chicken)',\n    image:\n      '//upload.wikimedia.org/wikipedia/commons/thumb/2/20/Coronation_Chicken.jpg/250px-Coronation_Chicken.jpg',\n    tags: ['Chicken', 'British'],\n  },\n  {\n    title: 'Crispy Chicken',\n    description:\n      '[Wikibook Cookbook link](https://en.wikibooks.org/wiki/Cookbook:Crispy_Chicken)',\n    image:\n      '//upload.wikimedia.org/wikipedia/commons/thumb/c/c5/Burger_King_Chicken_Nuggets_%2815423233415%29.jpg/250px-Burger_King_Chicken_Nuggets_%2815423233415%29.jpg',\n    tags: ['Chicken', 'American'],\n  },\n  {\n    title: 'Curry Chicken',\n    description:\n      '[Wikibook Cookbook link](https://en.wikibooks.org/wiki/Cookbook:Curry_Chicken)',\n    image:\n      '//upload.wikimedia.org/wikipedia/commons/thumb/e/e4/Indian_Curry_Chicken.jpg/250px-Indian_Curry_Chicken.jpg',\n    tags: ['Chicken', 'Indian'],\n  },\n  {\n    title: 'Deep Dish Pizza',\n    description:\n      '[Wikibook Cookbook link](https://en.wikibooks.org/wiki/Cookbook:Deep_Dish_Pizza)',\n    image:\n      '//upload.wikimedia.org/wikipedia/commons/thumb/d/d1/Pepperoni_pizza.jpg/300px-Pepperoni_pizza.jpg',\n    tags: ['Pork', 'Beef', 'American'],\n  },\n  {\n    title: 'Fleischkrapfen',\n    description:\n      '[Wikibook Cookbook link](https://en.wikibooks.org/wiki/Cookbook:Fleischkrapfen)',\n    image:\n      '//upload.wikimedia.org/wikipedia/commons/thumb/2/24/Fleischkrapfen_on_plate.jpg/250px-Fleischkrapfen_on_plate.jpg',\n    tags: ['Pork', 'Austrian'],\n  },\n  {\n    title: 'Frikadeller',\n    description:\n      '[Wikibook Cookbook link](https://en.wikibooks.org/wiki/Cookbook:Frikadeller)',\n    image:\n      '//upload.wikimedia.org/wikipedia/commons/thumb/0/0e/Frikadeller.jpg/300px-Frikadeller.jpg',\n    tags: ['Pork', 'Beef', 'German'],\n  },\n]\nexport default recipes\n","import { Action } from 'redux'\n\nexport class InvalidReducerCallError extends Error {\n  action: Action\n\n  constructor(action: Action, msg?: string) {\n    super(`${msg}: ${JSON.stringify(action)}`)\n    this.name = 'InvalidReducerCallError'\n    this.action = action\n  }\n}\n","import { Model } from 'app/db'\nimport { Reducer } from 'redux'\nimport { isReduxInternalAction } from 'util/types/redux'\nimport { InvalidReducerCallError } from 'util/errors'\nimport { createAction } from '@reduxjs/toolkit'\nimport recipeDataReducer, { RecipeListState } from './recipeDataSlice'\n\nexport type Rehydratable<State> = State & { rehydrated?: true }\n\nexport const minimalInitialState: Rehydratable<RecipeListState> = {\n  recipes: [],\n  rehydrated: undefined,\n}\n\nexport const getFromCouch = createAction<Model>('couchdb/getFromCouch')\n\nexport const addDefaultRecipes = createAction('couchdb/addInitialRecipes')\n\nconst getFromCouchReducer: Reducer<Rehydratable<RecipeListState>> = (\n  state,\n  action\n) => {\n  if (getFromCouch.match(action))\n    return { ...action.payload.state, rehydrated: true }\n\n  if (addDefaultRecipes.match(action))\n    return { ...recipeDataReducer(undefined, action), rehydrated: true }\n\n  if (!state?.rehydrated)\n    if (isReduxInternalAction(action)) return minimalInitialState\n    else\n      throw new InvalidReducerCallError(\n        action,\n        'Action dispatched before rehydrated'\n      )\n\n  return recipeDataReducer(state, action)\n}\n\nexport default getFromCouchReducer\n","import { Action } from 'redux'\n\nexport const isReduxInternalAction = (\n  action: Action<unknown>\n): action is Action<never> =>\n  typeof action.type == 'string' && action.type.startsWith('@@')\n","import { createAction } from '@reduxjs/toolkit'\n\nexport const makeRecipe = createAction<number | undefined>('recipes/makeRecipe')\nexport const removeRecipe = createAction<number | undefined>(\n  'recipes/removeRecipe'\n)\n","import { createSlice } from '@reduxjs/toolkit'\nimport { RootState } from 'app/rootReducer'\nimport { createSelector } from '@reduxjs/toolkit'\nimport { selectRecipes, shuffleRecipes } from './recipeDataSlice'\nimport { makeRecipe } from './combinedActions'\nexport interface RecipeUiState {\n  index: number\n  showDescription: boolean\n}\n\nlet initialState: RecipeUiState = {\n  index: 0,\n  showDescription: false,\n}\n\nconst recipeSlice = createSlice({\n  name: 'ui',\n  initialState,\n  reducers: {\n    nextRecipe(state) {\n      state.index++\n      state.showDescription = false\n    },\n    prevRecipe(state) {\n      state.index--\n      state.showDescription = false\n    },\n    toggleDescription(state) {\n      state.showDescription = !state.showDescription\n    },\n  },\n  extraReducers: b => {\n    b.addCase(makeRecipe, state => {\n      state.index = 0\n      state.showDescription = false\n    })\n    b.addCase(shuffleRecipes, state => {\n      state.index = 0\n      state.showDescription = false\n    })\n  },\n})\n\nexport const { nextRecipe, prevRecipe, toggleDescription } = recipeSlice.actions\n\nexport const selectRecipeUi = (state: RootState) => state.recipeUi\n\nexport const selectIndex = createSelector([selectRecipeUi], ui => ui.index)\n\nexport const selectShowDescription = createSelector(\n  [selectRecipeUi],\n  ui => ui.showDescription\n)\n\nexport const availabilityStateMap = createSelector(\n  [selectRecipes, selectIndex],\n  (recipes, index) => ({\n    hasPrev: index > 0,\n    has: index < recipes.length,\n    hasNext: index < recipes.length - 1,\n  })\n)\n\nexport default recipeSlice.reducer\n","import reduceReducers from 'reduce-reducers'\nimport recipes from './couchDataSlice'\nimport recipeUi from './uiSlice'\nimport { createReducer, combineReducers } from '@reduxjs/toolkit'\nimport { makeRecipe, removeRecipe } from './combinedActions'\n\nconst recipeReducer = combineReducers({ recipes, recipeUi })\n\nconst extraReducers = createReducer(\n  // This is the second reducer in the chain, initial state is always defined by recipeReducer\n  (undefined as unknown) as ReturnType<typeof recipeReducer>,\n  b => {\n    b.addCase(makeRecipe, (state, action) => {\n      const index = action.payload ?? state.recipeUi.index\n      const [selectedRecipe] = state.recipes.recipes.splice(index, 1)\n      state.recipes.recipes.push(selectedRecipe)\n    })\n\n    b.addCase(removeRecipe, (state, action) => {\n      const index = action.payload ?? state.recipeUi.index\n      if (index === state.recipeUi.index)\n        state.recipeUi.index = Math.max(state.recipeUi.index - 1, 0)\n      state.recipes.recipes.splice(index, 1)\n    })\n  }\n)\n\n// Some weird typing nonsense going on here\n// neither of these reducers will ever return undefined, but combining them somehow triggers as may\n// Seems compose functions are hard to type in general\n// This isn't even close to correct or reliable, but it should be good enough\nexport default reduceReducers(\n  extraReducers,\n  recipeReducer\n) as typeof recipeReducer\n","import React from 'react'\nimport { Box, Chip, TextField } from '@material-ui/core'\nimport { Autocomplete } from '@material-ui/lab'\n\ninterface Props {\n  recipeTags: string[]\n  setRecipeTags: (tags: string[]) => unknown\n}\n\nconst TagInput: React.FC<Props> = ({ recipeTags, setRecipeTags }) => (\n  <Box>\n    <Autocomplete\n      multiple\n      freeSolo\n      renderTags={(value = { recipeTags }, getTagProps) =>\n        value.map((option: React.ReactNode, index: any) => (\n          <Chip variant=\"outlined\" label={option} {...getTagProps({ index })} />\n        ))\n      }\n      onChange={(_, newValue: string[]) => setRecipeTags(newValue)}\n      renderInput={params => (\n        <TextField\n          {...params}\n          variant=\"filled\"\n          label=\"Recipe Tags\"\n          placeholder=\" \"\n          fullWidth\n        />\n      )}\n    />\n  </Box>\n)\n\nexport default TagInput\n","import React, { useState } from 'react'\nimport { connect } from 'react-redux'\nimport { Rating } from '@material-ui/lab'\n\nimport {\n  TextField,\n  Button,\n  Box,\n  Fab,\n  Dialog,\n  DialogTitle,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  Typography,\n} from '@material-ui/core'\nimport { Add as AddIcon } from '@material-ui/icons'\nimport { makeStyles, Theme, createStyles } from '@material-ui/core/styles'\n\nimport { addRecipe, removeRecipe } from './recipeSlice'\nimport TagInput from 'components/TagInput'\n\nconst mapDispatch = { addRecipe, removeRecipe }\n\ninterface OwnProps {}\n\nconst mapState = () => ({})\n\ntype Props = typeof mapDispatch & ReturnType<typeof mapState> & OwnProps\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    fab: {\n      position: 'fixed',\n      bottom: theme.spacing(2),\n      right: theme.spacing(2),\n    },\n    fieldset: {\n      borderColor: 'transparent',\n      marginLeft: 0,\n      paddingLeft: 0,\n    },\n    legend: {\n      pointerEvents: 'none',\n    },\n  })\n)\n\nconst AddRecipeDialog: React.FC<Props> = ({ addRecipe }) => {\n  const classes = useStyles()\n  const [open, setOpen] = useState(false)\n  const [recipeText, setRecipeText] = useState('')\n  const [recipeRating, setRecipeRating] = useState<number | undefined>()\n  const [recipeDescription, setRecipeDescription] = useState('')\n  const [recipeTags, setRecipeTags] = useState<string[]>([])\n\n  const submit = () => {\n    setOpen(false)\n    if (!recipeText.trim()) {\n      return\n    }\n    addRecipe({\n      title: recipeText,\n      image: encodeURI(\n        'https://loremflickr.com/400/250/' + recipeText + '?lock=1'\n      ),\n      rating: recipeRating,\n      description: recipeDescription,\n      tags: recipeTags,\n    })\n    cancel()\n  }\n\n  const cancel = () => {\n    setOpen(false)\n    setRecipeText('')\n    setRecipeRating(undefined)\n    setRecipeDescription('')\n    setRecipeTags([])\n  }\n\n  return (\n    <>\n      <Box className={classes.fab}>\n        <Fab onClick={() => setOpen(true)}>\n          <AddIcon />\n        </Fab>\n      </Box>\n      <Dialog\n        open={open}\n        onClose={cancel}\n        //onKeyPress={e => e.key === 'Enter' && submit()}\n      >\n        <DialogTitle>Add a recipe</DialogTitle>\n        <DialogContent>\n          <DialogContentText>Add your recipe information</DialogContentText>\n          <TextField\n            autoFocus\n            margin=\"dense\"\n            label=\"Recipe Title\"\n            fullWidth\n            value={recipeText}\n            onChange={e => setRecipeText(e.target.value)}\n          />\n          <TextField\n            variant=\"outlined\"\n            multiline\n            rows=\"3\"\n            placeholder=\"Add information about your recipe here...\"\n            margin=\"dense\"\n            label=\"Recipe Description\"\n            fullWidth\n            value={recipeDescription}\n            onChange={e => setRecipeDescription(e.target.value)}\n          />\n          <Box\n            component=\"fieldset\"\n            borderColor=\"transparent\"\n            className={classes.fieldset}\n          >\n            <Typography\n              component=\"legend\"\n              className={classes.legend}\n              color=\"textSecondary\"\n            >\n              How would you rate this?\n            </Typography>\n            <Rating\n              id=\"rating\"\n              name=\"size-large\"\n              size=\"large\"\n              value={recipeRating ?? null}\n              onChange={(_, newValue) => setRecipeRating(newValue)}\n            />\n          </Box>\n          <TagInput {...{ recipeTags, setRecipeTags }} />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={cancel} color=\"primary\">\n            Cancel\n          </Button>\n          <Button color=\"primary\" onClick={submit}>\n            Add\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </>\n  )\n}\n\nexport default connect(mapState, mapDispatch)(AddRecipeDialog)\n","import React from 'react'\n\nimport {\n  Box,\n  Card,\n  CardHeader,\n  CardContent,\n  CardMedia,\n  Typography,\n  Collapse,\n  IconButton,\n  CardActions,\n  Chip,\n} from '@material-ui/core'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport { Rating } from '@material-ui/lab'\n\nimport {\n  ExpandMore as ExpandMoreIcon,\n  ExpandLess as ExpandLessIcon,\n} from '@material-ui/icons'\n\nimport { Recipe } from './recipeSlice'\n\ninterface IconProps {\n  expand: boolean\n}\n\nconst ExpandableIcon: React.FC<IconProps> = ({ expand }) =>\n  expand ? <ExpandLessIcon /> : <ExpandMoreIcon />\n\n// A single pixel gif\nconst defaultPlaceholder =\n  'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs='\n\nconst useStyles = makeStyles({\n  media: {\n    height: 0,\n    paddingTop: '56.25%', // 16:9\n  },\n  expand: {\n    marginLeft: 'auto',\n  },\n})\n\ninterface OwnProps extends React.ComponentPropsWithoutRef<typeof Card> {\n  recipe: Recipe\n  placeholder?: string\n  showDescription?: boolean\n  toggleDescription?: React.MouseEventHandler<HTMLButtonElement>\n  menuButton?: React.ReactNode\n}\n\ntype Props = OwnProps\n\nconst RecipeCard: React.FC<Props> = ({\n  recipe,\n  placeholder,\n  showDescription,\n  toggleDescription,\n  menuButton,\n  ...props\n}) => {\n  const classes = useStyles()\n\n  return (\n    <Card {...props}>\n      <CardMedia\n        className={classes.media}\n        image={recipe.image ?? placeholder ?? defaultPlaceholder}\n      />\n\n      <CardHeader title={recipe.title} action={menuButton} />\n\n      <CardContent>\n        <Box>\n          {recipe.tags.map((txt, i) => (\n            <Chip label={txt} key={i} />\n          ))}\n        </Box>\n        <Rating name=\"recipeRating\" value={recipe.rating ?? null} readOnly />\n      </CardContent>\n\n      <CardActions>\n        <IconButton\n          className={classes.expand}\n          onClick={toggleDescription}\n          disabled={!recipe.description}\n        >\n          <ExpandableIcon expand={showDescription ?? false} />\n        </IconButton>\n      </CardActions>\n\n      <Collapse\n        in={showDescription && !!recipe.description}\n        timeout=\"auto\"\n        unmountOnExit\n      >\n        <CardContent>\n          <Typography paragraph variant=\"body2\" color=\"textSecondary\">\n            {recipe.description}\n          </Typography>\n        </CardContent>\n      </Collapse>\n    </Card>\n  )\n}\nexport default RecipeCard\n","import { useState, useEffect, useRef } from 'react'\nimport { tuple } from './types/misc'\n\nconst getSize = () => ({\n  width: window.innerWidth,\n  height: window.innerHeight,\n})\n\nexport const useWindowSize = () => {\n  const [windowSize, setWindowSize] = useState(getSize)\n\n  useEffect(() => {\n    const handleResize = () => setWindowSize(getSize())\n\n    window.addEventListener('resize', handleResize)\n    return () => window.removeEventListener('resize', handleResize)\n  }, [])\n\n  return windowSize\n}\n\nexport const useElSize = <T extends HTMLElement>() => {\n  const ref = useRef<T>(null)\n  const [bounds, setBounds] = useState<DOMRectReadOnly>()\n\n  const [ro] = useState(\n    () =>\n      (typeof ResizeObserver !== 'undefined' || undefined) &&\n      new ResizeObserver(([entry]) => setBounds(entry.contentRect))\n  )\n\n  useEffect(() => {\n    if (ref.current) ro?.observe(ref.current)\n    return () => ro?.disconnect()\n  }, [ro])\n\n  return tuple({ ref }, bounds)\n}\n","// To defeat type widening for arrays with specific types in specific indices\nexport const tuple = <T extends any[]>(...data: T) => data\n","import React, { useState, useRef } from 'react'\nimport { connect } from 'react-redux'\nimport { createSelector } from '@reduxjs/toolkit'\n\nimport RecipeCard from './RecipeCard'\nimport {\n  selectRecipes,\n  removeRecipe,\n  nextRecipe,\n  selectIndex,\n  selectShowDescription,\n  toggleDescription,\n  availabilityStateMap,\n  Recipe,\n  prevRecipe,\n} from './recipeSlice'\nimport {\n  Box,\n  Menu,\n  MenuItem,\n  ListItemIcon,\n  IconButton,\n  makeStyles,\n} from '@material-ui/core'\nimport { useWindowSize, useElSize } from 'util/hooks'\nimport { Delete as DeleteIcon, MoreVert as MenuIcon } from '@material-ui/icons'\n\nimport { useSpring, animated } from 'react-spring'\nimport { useDrag } from 'react-use-gesture'\n\nconst TUTORIAL_RECIPE: Readonly<Recipe> = {\n  title: 'No available recipes',\n  description: \"Add a recipe with the '+' button on the bottom right.\",\n  tags: [],\n}\n\nconst selectRecipe = createSelector(\n  [selectRecipes, selectIndex],\n  (recipes, index) => {\n    const [head, next] = recipes.slice(index, index + 1 + 1)\n    return [head, next ?? TUTORIAL_RECIPE]\n  }\n)\n\nconst mapState = createSelector(\n  [selectRecipe, selectShowDescription, selectIndex, availabilityStateMap],\n  (recipes, showDescription, currentRecipe, { has }) => ({\n    recipes,\n    showDescription,\n    currentRecipe,\n    has,\n  })\n)\n\nconst mapDispatch = { toggleDescription, removeRecipe, nextRecipe }\n\ninterface OwnProps {}\n\ntype Props = ReturnType<typeof mapState> & typeof mapDispatch & OwnProps\n\nconst useStyles = makeStyles({\n  cardStack: {\n    display: 'grid',\n    gridTemplate: '1fr / 1fr',\n    placeItems: 'center',\n    userSelect: 'none',\n    '& > *': {\n      gridColumn: '1 / 1',\n      gridRow: '1 / 1',\n      width: '100%',\n      height: '100%',\n    },\n    '& $top': { zIndex: 100 },\n    '& $bottom': { zIndex: -100 },\n  },\n  top: {},\n  bottom: {},\n})\n\nconst RecipeList: React.FC<Props> = ({\n  recipes: [head, next],\n  showDescription,\n  toggleDescription,\n  nextRecipe,\n  removeRecipe,\n  has,\n}) => {\n  const [menuAnchor, setMenuAnchor] = useState<null | HTMLElement>(null)\n  const classes = useStyles()\n  const { width } = useWindowSize()\n  const [bindCardSize, cardSize] = useElSize<HTMLDivElement>()\n\n  const edgeThreshold = width * 0.1\n\n  // Ref over state bc animations don't trigger a render,\n  // so setState may not take effect between calling and the frame which triggers onRest\n  const isLeaving = useRef<-1 | 0 | 1>(0)\n\n  const [springStyle, setSpring] = useSpring(() => ({\n    x: 0,\n    opacity: 1,\n    onRest: () => {\n      if (isLeaving.current) {\n        ;(isLeaving.current < 0 ? prevRecipe : nextRecipe)()\n        isLeaving.current = 0\n        setSpring({ x: 0, opacity: 1, reset: true })\n      }\n    },\n  }))\n\n  const bindDrag = useDrag(\n    ({ down, movement: [mx], xy: [abs_x], swipe: [swipe] }) => {\n      if (!isLeaving.current) {\n        setSpring({ x: down ? mx : 0 })\n        if (swipe || Math.abs(width - abs_x) > edgeThreshold) {\n          setSpring({\n            opacity: 0,\n            // Width not defined in node environments, ie tests\n            x:\n              ((width + (cardSize?.width ?? 0)) / 2) * (swipe || Math.sign(mx)),\n          })\n          isLeaving.current = (swipe || Math.sign(mx)) as -1 | 0 | 1\n        }\n      }\n    }\n  )\n\n  const closeMenu = () => setMenuAnchor(null)\n  const headCard = head && (\n    <animated.div style={springStyle} {...bindDrag()} {...bindCardSize}>\n      <RecipeCard\n        recipe={head}\n        className={classes.top}\n        showDescription={showDescription}\n        toggleDescription={() => toggleDescription()}\n        menuButton={\n          <IconButton\n            onClick={e => setMenuAnchor(e.currentTarget)}\n            disabled={!has}\n          >\n            <MenuIcon />\n          </IconButton>\n        }\n      />\n    </animated.div>\n  )\n\n  const nextCard = (\n    <RecipeCard\n      recipe={next}\n      className={classes.bottom}\n      menuButton={\n        <IconButton disabled={!has}>\n          <MenuIcon />\n        </IconButton>\n      }\n    />\n  )\n\n  return (\n    <>\n      <Menu anchorEl={menuAnchor} open={!!menuAnchor} onClose={closeMenu}>\n        <MenuItem\n          onClick={() => {\n            closeMenu()\n            removeRecipe()\n          }}\n        >\n          <ListItemIcon>\n            <DeleteIcon />\n          </ListItemIcon>\n          Delete\n        </MenuItem>\n      </Menu>\n      <Box className={classes.cardStack}>\n        {headCard}\n        {nextCard}\n      </Box>\n    </>\n  )\n}\n\nexport default connect(mapState, mapDispatch)(RecipeList)\n","import React from 'react'\nimport { connect } from 'react-redux'\n\nimport { Button, ButtonGroup } from '@material-ui/core'\nimport {\n  NavigateBefore as PrevIcon,\n  NavigateNext as NextIcon,\n} from '@material-ui/icons'\n\nimport {\n  nextRecipe,\n  prevRecipe,\n  availabilityStateMap,\n  selectIndex,\n  makeRecipe,\n} from './recipeSlice'\n\nimport { createSelector } from '@reduxjs/toolkit'\n\nconst mapState = createSelector(\n  [availabilityStateMap, selectIndex],\n  (has, index) => ({ ...has, index })\n)\n\nconst mapDispatch = { nextRecipe, prevRecipe, makeRecipe }\n\ninterface OwnProps {}\n\ntype Props = ReturnType<typeof mapState> & typeof mapDispatch & OwnProps\n\nconst Reactions: React.FC<Props> = ({\n  nextRecipe,\n  prevRecipe,\n  makeRecipe,\n  hasPrev,\n  has,\n  hasNext,\n  index: current,\n}) => (\n  <ButtonGroup color=\"primary\" variant=\"contained\" fullWidth>\n    <Button onClick={() => prevRecipe()} disabled={!hasPrev}>\n      <PrevIcon />\n      Previous\n    </Button>\n\n    <Button onClick={() => makeRecipe(current)} disabled={!has}>\n      Select\n    </Button>\n\n    <Button onClick={() => nextRecipe()} disabled={!hasNext}>\n      Next\n      <NextIcon />\n    </Button>\n  </ButtonGroup>\n)\n\nexport default connect(mapState, mapDispatch)(Reactions)\n","import React from 'react'\n\nimport { Container } from '@material-ui/core'\n\nimport AddRecipe from '../features/recipes/AddRecipe'\nimport RecipeStack from '../features/recipes/RecipeStack'\nimport Reactions from '../features/recipes/Reactions'\n\nconst App: React.FC = () => (\n  <Container maxWidth=\"xs\">\n    <RecipeStack />\n    <Reactions />\n    <AddRecipe />\n  </Container>\n)\n\nexport default App\n","import recipeReducer from 'features/recipes/recipeSlice'\n\nconst rootReducer = recipeReducer\n\nexport type RootState = ReturnType<typeof rootReducer>\n\nexport default rootReducer\n","import * as Sentry from '@sentry/browser'\nimport {\n  configureStore,\n  getDefaultMiddleware,\n  Middleware,\n} from '@reduxjs/toolkit'\nimport rootReducer from './rootReducer'\n\nconst sentryReporter: Middleware = store => next => action => {\n  Sentry.addBreadcrumb({\n    level: Sentry.Severity.Info,\n    message: 'Dispatched action',\n    data: { ...action },\n  })\n  try {\n    return next(action)\n  } catch (error) {\n    Sentry.setExtras({ state: store.getState(), action })\n    Sentry.captureException(error)\n    throw error\n  }\n}\n\nconst store = configureStore({\n  reducer: rootReducer,\n  devTools: process.env.NODE_ENV !== 'production',\n  middleware: [sentryReporter, ...getDefaultMiddleware()],\n})\n\nif (process.env.NODE_ENV === 'development' && module.hot) {\n  module.hot.accept('./rootReducer', () => {\n    store.replaceReducer(rootReducer)\n  })\n}\n\nexport type AppDispatch = typeof store.dispatch\n\nexport type Store = typeof store\nexport default store\n","import React, { ErrorInfo } from 'react'\nimport * as Sentry from '@sentry/browser'\nimport { Button, Container, Typography } from '@material-ui/core'\nimport store from '../app/store'\n\ninterface Props {}\n\ninterface State {\n  hasError: boolean\n  eventId?: string\n}\n\n// Some lifecycle not implemented as hooks yet, particularly getDerivedStateFromError and componentDidCatch.\nexport default class extends React.Component<Props, State> {\n  constructor(props: Props) {\n    super(props)\n    this.state = { hasError: false }\n  }\n\n  static getDerivedStateFromError(_error: Error) {\n    // Update state so the next render will show the fallback UI.\n    return { hasError: true }\n  }\n\n  componentDidCatch(error: Error, errorInfo: ErrorInfo) {\n    Sentry.setExtras(errorInfo)\n    Sentry.setExtras({ state: store.getState() })\n    const eventId = Sentry.captureException(error)\n    this.setState({ eventId })\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        <Container maxWidth=\"sm\">\n          <Typography>\n            It looks like you{\"'\"}ve found an error. Please consider giving us a\n            bit more information about what you were doing so we can continue to\n            improve.\n          </Typography>\n          <Button\n            variant=\"contained\"\n            onClick={() =>\n              Sentry.showReportDialog({ eventId: this.state.eventId })\n            }\n          >\n            Report feedback\n          </Button>\n        </Container>\n      )\n    }\n\n    return this.props.children\n  }\n}\n","import { last } from 'lodash'\nimport { ActionCreator, Action, Dispatch } from 'redux'\n\nexport type VoiceActionCallback = (result: string) => void\n\nexport type VoiceRecognitionArgs = {\n  callback: VoiceActionCallback\n  commands: Array<string>\n}\n\ndeclare global {\n  interface Window {\n    webkitSpeechRecognition?: typeof SpeechRecognition\n  }\n}\n\n// Firefox (after config option) and opera have no prefix, chrome and edge have prefix\nwindow.SpeechRecognition =\n  window.SpeechRecognition ?? window.webkitSpeechRecognition\n\nexport const initVoiceRecognition =\n  // Be undefined when speech recognition support is undefined\n  (typeof SpeechRecognition !== 'undefined' || undefined) &&\n  (({ callback, commands }: VoiceRecognitionArgs) => {\n    const grammar = `#JSGF V1.0;\n    grammar in;\n    public <response> = ${commands.join(' | ')};\n  `\n\n    const recogniser = new SpeechRecognition()\n    recogniser.grammars.addFromString(grammar)\n    recogniser.onend = () => recogniser.start()\n\n    recogniser.onresult = res => {\n      const cmd = last(res.results ?? [])?.[0]?.transcript?.trim()\n      if (cmd) return callback(cmd)\n    }\n\n    recogniser.start()\n\n    return recogniser\n  })\n\nexport const voiceReduxAdaptor = (\n  dispatch: Dispatch,\n  actions: Record<string, ActionCreator<Action>>\n): VoiceRecognitionArgs => ({\n  callback(cmd: keyof typeof actions) {\n    const a = actions[cmd]\n    if (a) dispatch(a())\n  },\n  commands: Object.keys(actions),\n})\n","import React from 'react'\nimport { useSelector } from 'react-redux'\nimport { RootState } from 'app/rootReducer'\n\ninterface Props {\n  loading?: React.ReactNode\n}\n\nconst RehydrateGuard: React.FC<Props> = ({ loading, children }) => {\n  const rehydrated = useSelector(\n    ({ recipes: { rehydrated } }: RootState) => rehydrated\n  )\n  return <>{rehydrated ? children : loading}</>\n}\n\nexport default RehydrateGuard\n","import { Store } from 'redux'\nimport { isEqual, identity } from 'lodash'\n\nexport const observeStore = <StoreT extends Store, T>(\n  mstore: StoreT,\n  onChange: (t: T) => void,\n  selector: (state: ReturnType<StoreT['getState']>) => T = identity\n) => {\n  let currentState: T\n\n  const handleChange = () => {\n    let nextState = selector(mstore.getState())\n    if (!isEqual(nextState, currentState)) {\n      currentState = nextState\n      onChange(currentState)\n    }\n  }\n  const unsubscribe = mstore.subscribe(handleChange)\n  handleChange()\n  return unsubscribe\n}\n","const testPromises: Promise<unknown>[] = []\n\nexport const testAwait = (p: Promise<unknown>) => {\n  if (process.env.NODE_ENV !== 'production') testPromises.push(p)\n}\n\nexport const pending = () => Promise.all(testPromises)\n","export const isPouchDBError = (\n  result: PouchDB.Core.Error | any\n): result is PouchDB.Core.Error => {\n  return !!(result as PouchDB.Core.Error).error\n}\n","import { observeStore } from 'util/redux'\nimport { testAwait } from 'util/test'\nimport { Store } from 'app/store'\nimport { RootState } from 'app/rootReducer'\nimport { isPouchDBError } from 'util/types/pouchdb'\nimport PouchDB from 'pouchdb'\nimport Upsert from 'pouchdb-upsert'\nimport {\n  shuffleRecipes,\n  getFromCouch,\n  addDefaultRecipes,\n  RecipeListState,\n} from '../features/recipes/recipeSlice'\n\nPouchDB.plugin(Upsert)\n\nexport interface Model {\n  state: Omit<RootState['recipes'], 'rehydrated'>\n}\n\nconst shuffleSalt = Date.now()\n\nconst STATE_DOC = 'State' as const\n\nexport const init = async (\n  store: Store,\n  { host = 'http://localhost', port = 5984, name = 'cards' } = {}\n) => {\n  const db = new PouchDB<Model>(name)\n  // Initial get\n  try {\n    const dbget = await db.get(STATE_DOC)\n    store.dispatch(getFromCouch(dbget))\n  } catch (e) {\n    if (isPouchDBError(e) && e.status === 404) {\n      store.dispatch(addDefaultRecipes())\n    } else throw e\n  }\n  store.dispatch(shuffleRecipes(shuffleSalt))\n\n  // Sync remote\n  db.sync<Model>(`${host}:${port}/${name}`, {\n    live: true,\n    retry: true,\n  }).on('change', change => store.dispatch(getFromCouch(change.change.docs[0])))\n\n  observeStore<Store, RecipeListState>(\n    store,\n    state =>\n      testAwait(\n        (async state => {\n          try {\n            await db.upsert(STATE_DOC, oldstate => ({\n              ...oldstate,\n              state,\n            }))\n          } catch (error) {\n            if (isPouchDBError(error)) console.error(error)\n            throw error\n          }\n\n          return db\n        })(state)\n      ),\n    state => state.recipes\n  )\n}\n","import { makeStyles } from '@material-ui/core'\n\nexport default makeStyles({\n  '@global': { body: { overflow: 'hidden' } },\n})\n","import React from 'react'\nimport { render } from 'react-dom'\nimport { Provider } from 'react-redux'\nimport * as serviceWorker from './serviceWorker'\nimport * as Sentry from '@sentry/browser'\n\nimport App from './components/App'\nimport store from './app/store'\nimport ErrorBoundary from 'components/ErrorBoundary'\n\nimport { version as release } from '../package.json'\nimport { initVoiceRecognition, voiceReduxAdaptor } from 'features/voice'\nimport {\n  nextRecipe,\n  prevRecipe,\n  makeRecipe,\n} from 'features/recipes/recipeSlice'\nimport RehydrateGuard from 'components/RehydrateGuard'\nimport { LinearProgress } from '@material-ui/core'\nimport { init as initDB } from 'app/db'\nimport useStyles from 'globalStyle'\n\nSentry.init({\n  dsn: 'https://60a4c38b006549769ba249366b78887b@sentry.io/1850302',\n  release,\n  environment: process.env.NODE_ENV,\n})\n\ninitDB(store, {\n  host: process.env.REACT_APP_COUCHDB_HOST,\n  port:\n    (process.env.REACT_APP_COUCHDB_PORT &&\n      parseInt(process.env.REACT_APP_COUCHDB_PORT)) ||\n    undefined,\n  name: process.env.REACT_APP_COUCHDB_DB,\n})\n\nconst Configured: React.FC = () => {\n  useStyles()\n\n  return (\n    <ErrorBoundary>\n      <Provider store={store}>\n        <RehydrateGuard loading={<LinearProgress />}>\n          <App />\n        </RehydrateGuard>\n      </Provider>\n    </ErrorBoundary>\n  )\n}\nrender(<Configured />, document.getElementById('root'))\n\ninitVoiceRecognition?.(\n  voiceReduxAdaptor(store.dispatch, {\n    next: nextRecipe,\n    back: prevRecipe,\n    select: makeRecipe,\n  })\n)\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n"],"sourceRoot":""}